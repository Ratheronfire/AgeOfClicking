<!-- Hidden tooltip elements -->
<!-- We need to place these tooltips here so that they're always available to subcomponents regardless of which tabs are/aren't open. -->

<div *ngFor="let resource of getResources()">
  <div class="tooltip" [id]="'tooltip-resource-' + resource.resourceEnum">
    <div class="resource-tooltip-icon">
        <img class="resource-img" id="{{resource.name | resourceId}}" src="assets/sprites/transparent.png" alt="{{resource.name}}">
        <img class="background" src="assets/sprites/inventoryBack.png" width="48px" height="48px">
    </div>

    <mat-card-title>
      {{resource.name | titlecase}}
    </mat-card-title>
    <mat-card-subtitle>
      {{resource.resourceDescription}}
    </mat-card-subtitle>
    <mat-card-content>
      {{getTooltipMessage(resource)}}
    </mat-card-content>
  </div>
</div>

<div *ngFor="let upgrade of getUpgrades(false, false, false)">
  <div class="tooltip" [id]="'tooltip-upgrade-' + upgrade.id">
    <mat-card-title>{{upgrade.name}}</mat-card-title>
    <mat-card-subtitle>{{upgrade.description}}</mat-card-subtitle>

    <mat-card-content>
      <div *ngFor="let cost of upgrade.resourceCosts">
        {{cost.resourceCost  | longNumber}} {{getResource(cost.resourceEnum).name | titlecase}}
      </div>
    </mat-card-content>
  </div>
</div>

<div *ngFor="let task of getTasks()">
  <div class="tooltip" [id]="'tooltip-task-' + task.id">
    <mat-card-title>
      {{task.title}}
    </mat-card-title>

    <mat-card-content *ngIf="task.isTutorial">
      {{task.tutorialText}}
    </mat-card-content>
  </div>
</div>

<div class="game-container" [class.game-is-mobile]="mobileQuery.matches" [@.disabled]="disableAnimations">
  <mat-toolbar color="primary" class="game-toolbar">
    <h1 class="game-app-name">Age of Clicking</h1>
    <div class="sidenav-buttons">
      <button mat-flat-button (click)="hideResourceList = !hideResourceList">
        <mat-icon>map</mat-icon><p class="toolbar-button-text" *ngIf="!mobileQuery.matches">Expand Map</p>
      </button>
      <button mat-flat-button (click)="snav.toggle()" [matBadge]="affordableUpgradeCount" [matBadgeHidden]="affordableUpgradeCount <= 0" matBadgePosition="before" matBadgeColor="accent">
        <mat-icon>menu</mat-icon><p class="toolbar-button-text" *ngIf="!mobileQuery.matches">Menu</p>
      </button>
    </div>
  </mat-toolbar>

  <mat-sidenav-container class="game-sidenav-container" [style.marginTop.px]="mobileQuery.matches ? 56 : 0">
    <mat-sidenav #snav [mode]="mobileQuery.matches ? 'over' : 'side'" [opened]="!mobileQuery.matches" [fixedInViewport]="mobileQuery.matches" position="end"
      fixedTopGap="56">
      <mat-nav-list>
        <mat-tab-group class="tab-group" dynamicHeight>
          <mat-tab label="Units">
            <app-units></app-units>
          </mat-tab>
          <mat-tab label="Tasks">
            <app-tasks></app-tasks>
          </mat-tab>
          <mat-tab label="Store">
            <app-store></app-store>
          </mat-tab>
          <mat-tab label="Upgrades{{affordableUpgradeCount > 0 ? ' (' + affordableUpgradeCount + ')' : ''}}">
            <app-upgrades></app-upgrades>
          </mat-tab>
          <mat-tab label="Log">
            <app-messages></app-messages>
          </mat-tab>
          <mat-tab label="Settings">
            <app-settings></app-settings>
          </mat-tab>
        </mat-tab-group>
      </mat-nav-list>
    </mat-sidenav>
    <mat-sidenav-content>
      <div class="main-pane">
        <app-harvest class="resource-list stone" [style.display]="hideResourceList? 'none': ''"></app-harvest>
        <app-map class="map" [style.display]="mobileQuery.matches && !hideResourceList? 'none': ''"></app-map>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
